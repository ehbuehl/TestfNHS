<!DOCTYPE html>
<html>
  <title>EHS NHS Portal</title>
  <body>
  <h2 id="LUI">Edgewood High School National Honor Society Portal</h2>
    
<link rel="stylesheet" href="style.css">

<ul>
<li><a class="currentp" href="home.html">Home</a></li>
<li><a href="attend.html">Attendance</a></li>
<li><a href="files.html">File Search</a></li>
<li><a href="about.html">About</a></li>
</ul>

    <div class="vl"></div>

<div id="demo">
  <input id="FirstN" placeholder="First Name"></input>
  <br>
  <input id="LastN" placeholder="Last Name"></input>
  <br>
  <input id="Passkey" placeholder="Passkey"></input>
<br>
<br>
<button type="button" onclick="loadDoc()">Login</button>
</div>

<script>
var result = 0;
var passresult = 0;

function loadDoc() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      result = this.responseText
      getP()
    }
  };
  xhttp.open("GET", "ajax_dataget.txt", true);
  xhttp.send();
}

function getP() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      passresult = this.responseText
      passC()
    }
  };
  xhttp.open("GET", "ajax_passget.txt", true);
  xhttp.send();
}

  function passC(){
    if ((document.getElementById("Passkey").value)!=""){
     if ((passresult.includes(document.getElementById("Passkey").value))){
     var prof = result.slice(result.lastIndexOf("&",result.search(document.getElementById("Passkey").value)),result.indexOf("$",result.search(document.getElementById("Passkey").value)))+"$"
        if ((document.getElementById("FirstN").value)!="" && (document.getElementById("LastN").value)!=""){
         if (prof.includes(document.getElementById("FirstN").value) && prof.includes(document.getElementById("LastN").value)){
     document.getElementById("demo").innerHTML = "User: " + prof.slice(prof.search("#")+1,prof.search("%")) + ", " + prof.slice(prof.search("&")+1,prof.search("#")) + "<br>" + "Number of Meetings Present: " + prof.slice(prof.search("Present")+8,prof.search("@"))+ "<br>" + "Number of Meetings Absent: " + prof.slice(prof.search("Absent")+7,prof.search("$")-1)
     }}}}}

</script>

</body>
</html>
